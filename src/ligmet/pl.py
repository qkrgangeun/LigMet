from collections import defaultdict
from pathlib import Path
from typing import Type

import torch
from lightning import LightningDataModule, LightningModule